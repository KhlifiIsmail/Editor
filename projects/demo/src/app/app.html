<div class="app-container">
  <!-- Top Header -->
  <header class="app-header">
    <div class="header-left">
      <h1 class="app-title">
        <span class="title-icon">âš¡</span>
        Monaco Pattern Editor
      </h1>
    </div>

    <div class="header-right">
      <button class="theme-toggle" (click)="toggleTheme()">
        {{ themeService.currentMode() === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™' }}
      </button>
    </div>
  </header>

  <!-- Main Split Layout -->
  <div class="split-container">
    <!-- Left Panel: Problem Description -->
    <div class="left-panel">
      <div class="panel-header">
        <h2>Problem</h2>
      </div>

      <div class="panel-content">
        <div class="problem-section">
          <h3>Two Sum</h3>
          <div class="difficulty easy">Easy</div>
        </div>

        <div class="problem-description">
          <p>
            Given an array of integers <code>nums</code> and an integer <code>target</code>,
            return indices of the two numbers such that they add up to <code>target</code>.
          </p>
          <p>
            You may assume that each input would have exactly one solution, and you may not use the same element twice.
          </p>
          <p>
            You can return the answer in any order.
          </p>
        </div>

        <div class="examples">
          <h4>Example 1:</h4>
          <pre><code>Input: nums = [2,7,11,15], target = 9
Output: [0,1]
Explanation: Because nums[0] + nums[1] == 9, we return [0, 1].</code></pre>

          <h4>Example 2:</h4>
          <pre><code>Input: nums = [3,2,4], target = 6
Output: [1,2]</code></pre>
        </div>

        <div class="constraints">
          <h4>Constraints:</h4>
          <ul>
            <li>2 â‰¤ nums.length â‰¤ 10â´</li>
            <li>-10â¹ â‰¤ nums[i] â‰¤ 10â¹</li>
            <li>-10â¹ â‰¤ target â‰¤ 10â¹</li>
          </ul>
        </div>

        <!-- Detected Patterns Section -->
        <div class="detected-patterns" *ngIf="detectedPatterns().length > 0">
          <h4>ğŸ¯ Detected Patterns:</h4>
          <div class="patterns-list">
            <mpe-pattern-badge
              *ngFor="let pattern of detectedPatterns()"
              [pattern]="pattern">
            </mpe-pattern-badge>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Panel: Editor + Results -->
    <div class="right-panel">
      <!-- Toolbar -->
      <div class="editor-toolbar">
        <div class="toolbar-left">
          <span class="language-label">JavaScript</span>
        </div>

        <div class="toolbar-right">
          <button
            class="toolbar-btn"
            (click)="detectPatterns()"
            [disabled]="isDetecting()">
            {{ isDetecting() ? 'ğŸ” Detecting...' : 'ğŸ¯ Detect Patterns' }}
          </button>

          <button class="toolbar-btn" (click)="analyzeComplexity()">
            ğŸ“Š Complexity
          </button>

          <button class="toolbar-btn" (click)="openHints()">
            ğŸ’¡ Hint
          </button>

          <button
            class="toolbar-btn run-btn"
            (click)="executeCode()"
            [disabled]="isExecuting()">
            {{ isExecuting() ? 'â³ Running...' : 'â–¶ï¸ Run' }}
          </button>
        </div>
      </div>

      <!-- Editor Area -->
      <div class="editor-area">
        <mpe-monaco-editor
          [language]="'javascript'"
          [initialCode]="initialCode"
          [height]="'100%'"
          (codeChange)="onCodeChange($event)">
        </mpe-monaco-editor>

        <!-- Complexity Badges Overlay -->
        <div class="complexity-badges" *ngIf="complexity()">
          <mpe-complexity-badge [complexity]="complexity()!" [type]="'time'">
          </mpe-complexity-badge>
          <mpe-complexity-badge [complexity]="complexity()!" [type]="'space'">
          </mpe-complexity-badge>
        </div>
      </div>

      <!-- Test Results Panel (Bottom) -->
      <div class="results-panel" *ngIf="testResults() || isExecuting()">
        <mpe-test-results [result]="testResults()!" [loading]="isExecuting()">
        </mpe-test-results>
      </div>
    </div>
  </div>

  <!-- Hint Overlay Modal -->
  <mpe-hint-overlay
    [hints]="hints()"
    [isOpen]="isHintOverlayOpen()"
    [currentLevel]="currentHintLevel()"
    (close)="closeHints()"
    (nextHint)="onNextHint($event)"
    (previousHint)="onPreviousHint($event)">
  </mpe-hint-overlay>
</div>
